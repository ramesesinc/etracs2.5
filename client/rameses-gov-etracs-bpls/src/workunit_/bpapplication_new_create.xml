<workunit>
    <invokers>
        <invoker type="home.action" caption="New Business Application"  action="start" target="window"  role="BUSINESSINFO,LICENSING"/>
        <invoker type="extActions" caption="Continue" action="openApplication"  visibleWhen="#{state == 'save-success'}"/>
        <invoker type="extActions" caption="Print BIN" action="printBIN"  visibleWhen="#{state == 'save-success'}"/>
    </invokers>
    
    <code class="com.rameses.gov.etracs.bpls.application.BPNewApplication"/>
    
    <pageflow>
        <start>
            <transition to="initial" name="create"/>
            <transition to="#{entity.state}" name="open"/>
        </start>
        
        <page name="initial" title="Specify Basic Info (New Application)">
            <transition to="check-business-name" caption="Next" name="next" mnemonic="N" immediate="false"/>
        </page>
        
        <process name="check-business-name" action="checkBusinessName">
            <transition to="verify-business-name" cond="#{searchNamePass==false}"/>
            <transition to="update-app-info" cond="#{searchNamePass==true}"/>
        </process>
            
        <page name="verify-business-name" title="Business Name Verification (New Application)">
            <transition to="initial" caption="Back" mnemonic="B"/>
            <transition to="update-app-info" caption="Next" name="next" mnemonic="N"/>
        </page>

        <page name="update-app-info" title="Specify Business Information (New Application)">
            <transition to="initial" caption="Back" mnemonic="B" name="back"/>
            <transition to="update-lob" caption="Next" name="next" mnemonic="N" action="verifyAppInfo"/>
        </page>
        
        <page name="update-lob" title="Specify Line of Business (New Application)">
            <transition to="update-app-info" caption="Back" mnemonic="B" name="back"/>
            <transition to="update-assessment-info" caption="Next" name="next" mnemonic="N"  action="verifyLOB"/>
        </page>

        <page name="update-assessment-info" title="Specify Assessment Information (New Application)" >
            <transition to="update-lob" caption="Back" mnemonic="B" name="back"/>
            <transition to="confirm" caption="Next" name="next" mnemonic="N" action="verifyAssessmentInfo"/>
        </page>
        
        <page name="confirm" title="Confirm (New Application)">
            <transition to="update-assessment-info" caption="Back" mnemonic="B" name="back"/>
            <transition to="save-success" caption="Submit" mnemonic="S" name="save" action="saveCreate"
            confirm="You are about to save this transaction. Continue?"/>
        </page>
        
        <page name="save-success" title="Save Success (New Application)">
            <transition to="initial" caption="Add Another" mnemonic="A" action="initNew"/>
        </page>

        <end/>
    </pageflow>
    
    <pages>
        <page name="initial" template="com.rameses.gov.etracs.bpls.application.SpecifyBusinessInfoPage"/>
        <page name="verify-business-name" template="com.rameses.gov.etracs.bpls.application.VerifyBusinessName"/>
        <page name="update-app-info" template="com.rameses.gov.etracs.bpls.application.UpdateAppInfoPage"/>
        <page name="update-lob" template="com.rameses.gov.etracs.bpls.application.SpecifyLOBPage"/>
        <page name="update-assessment-info" template="com.rameses.gov.etracs.bpls.application.UpdateAssessmentInfoPage"/>
        <page name="confirm" template="com.rameses.gov.etracs.bpls.application.ViewApplicationInfoPage"/>
        <page name="save-success" template="com.rameses.gov.etracs.bpls.application.SuccessPage"/>
    </pages>
    
    
</workunit>