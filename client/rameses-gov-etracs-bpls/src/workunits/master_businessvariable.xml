<workunit>
    <invokers>
        <invoker type="businessvariable:create" action="init" caption="Variable"/>
        <invoker type="businessvariable:open" action="open" caption="Variable"/>
    </invokers>
    <code>
        <![CDATA[
            import com.rameses.rcp.common.*;
            import com.rameses.rcp.annotations.*;
            import com.rameses.osiris2.common.*;
            
            class BusinessVariableController extends CRUDController
            {
                @PropertyChangeListener
                def listener = [
                    "entity.datatype": {o->
                        entity.arrayvalues = []
                        binding.refresh('arrayvalue')
                    }
                ]
                
                String serviceName = 'BusinessVariableService'
                String entityName = 'businessvariable'
                String prefixId = 'BV'
                
                def arrayvalue
                def datatypes = LOV.VAR_DATA_TYPES
                
                Map createEntity() {
                    return [ arrayvalues:[] ]
                }
                
                void addArrayValue() {
                    def value = MsgBox.prompt("Enter value: ")
                    if( !value || value == 'null' ) return
                    if( !entity.arrayvalues.find{ it == value } ) {
                        entity.arrayvalues.add(value.toUpperCase())
                        binding.refresh('arrayvalue')
                    }
                }
                
                void removeArrayValue() {
                    if( MsgBox.confirm("Remove selected array value?") ) {
                        entity.arrayvalues.remove(arrayvalue)
                        binding.refresh('arrayvalue')
                    }
                }
            }
        ]]>
    </code>
    <pages>
        <page template="com.rameses.gov.etracs.bpls.lob.BusinessVariablePage"/>
    </pages>
</workunit>