<workunit >
    <invokers>
       <invoker type="home.action" caption="BP Billing" action="viewReport" target="window"/>
       
       <invoker type="formActions" caption="Back" action="_close" mnemonic="b" shortcut="ctrl B" /> 
    </invokers>
    
    <code>
        <![CDATA[    
        import com.rameses.rcp.annotations.*
        import com.rameses.rcp.common.*
        import com.rameses.osiris2.client.*
        import com.rameses.osiris2.common.*
        import java.rmi.server.*;
         import com.rameses.osiris2.reports.*;
        
        class  BPBillingReportController  {
        
            def entity;
        
            def title = "BP Billing"
            
            def reportPath = "com/rameses/gov/etracs/bpls/reports/billing/"
            
            @Service("ReportParameterService") 
            def paramsvc
         
            void viewReport() {
                // sample data 
                entity = [
                   taxpayername: "GERASMIO, EDUARDO C", taxpayeraddress:"PALM COURT SUBD., TOMAS CABILI ILIGAN CITY", 
                   billdate: java.sql.Date.valueOf("2013-02-27"), expirydate:java.sql.Date.valueOf("2013-03-31"),grandtotal:10000.0 ,
                   items:[
                        [ appno:'1212', txntype:"renew", docstate:"APPROVED", txndate:java.sql.Date.valueOf("2013-02-01"), tradename:"my sari sari store" , 
                          address:"ILIGAN", barcode:"110119", first_qtr_total:2500.0, second_qtr_total:2500.0, third_qtr_total:2500.0, fourth_qtr_total:2500.0,  
                          totalamount:10000.0, totalsurcharge:0.0, totalinterest:0.0, grandtotal:0.0,
                          taxfees:[
                            [year:2013, qtr:1, lobname:'SARI-Sari', applicationtype:'RENEW', accttitle:'BUSINESS TAX',
                             duedate:java.sql.Date.valueOf("2013-02-28"), amount: 10000.0, surcharge:0.0, interest:0.0, total:10000.0]
                          ]
                         ]
                   ]
                ]
            
                report.viewReport();
            } 
            
            def report = [
                getReportName : { return reportPath + "BPBilling.jasper" },
                getReportData : { return  entity },
                getParameters : { return paramsvc.getStandardParameter() },
                getSubReports : { return [
                        new SubReport("BPBillingBusiness", reportPath + "BPBillingBusiness.jasper"),
                        new SubReport("BPBillingBusinessItem", reportPath + "BPBillingBusinessItem2.jasper")
                    ] as SubReport[];
                }
            ] as ReportModel
           
        }
        ]]>
        
    </code>
    
    <pages>
        <page template="com.rameses.osiris2.common.ui.ReportPreviewPage"/>
    </pages>
    
</workunit>