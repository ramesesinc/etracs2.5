<?xml version="1.0" encoding="UTF-8"?>
<workunit>
    <invokers>
        <invoker folderid="/explorer/setting/treasury" action="init" caption="Collection Setting" target="window" index="6"/>
        <invoker type="quick_launcher" code="COLSETTING" action="init" caption="Collection Setting" index="6"/>
        
        <invoker type="formActions" action="_close" shortcut="ctrl W" caption="Close" mnemonic="c" immediate="true"/>
        <invoker type="formActions" action="save" shortcut="ctrl S" caption="Save" mnemonic="s"/>
    </invokers>
    <code>
        <![CDATA[
            import com.rameses.rcp.common.*;
            import com.rameses.rcp.annotations.*;
            import com.rameses.osiris2.client.*;

            class CollectionSettingController 
            {
                @Binding
                binding

                @Service('CollectionSettingMasterService')
                def svc;
                
                def formActions
                def navActions
                def styleRules
                def title = 'Collection Setting'
                
                def entity
                def cattleownership
                def cattletransfer
                def marriage
                def burial

                void init() {
                    entity = svc.open()
                    cattleownership = [objid:entity.info.lcoacctid, accttitle:entity.info.lcoaccttitle]
                    cattletransfer = [objid:entity.info.lctacctid, accttitle:entity.info.lctaccttitle]
                    marriage = [objid:entity.info.marriageacctid, accttitle:entity.info.marriageaccttitle]
                    burial = [objid:entity.info.burialacctid, accttitle:entity.info.burialaccttitle]
                }

                void save() {
                    entity = svc.save( entity )
                    MsgBox.alert('Record has been successfully saved.')
                }
                
                def lookupOwnershipAccount = InvokerUtil.lookupOpener('itemacct:lookup',[onselect:{ 
                        cattleownership = it 
                        entity.info.lcoacctid = it?.objid
                        entity.info.lcoaccttitle = it?.accttitle
                        entity.info.lcofundid = it?.fundid
                    }])
                    
                def lookupTransferAccount = InvokerUtil.lookupOpener('itemacct:lookup',[onselect:{ 
                        cattletransfer = it
                        entity.info.lctacctid = it?.objid
                        entity.info.lctaccttitle = it?.accttitle
                        entity.info.lctfundid = it?.fundid
                    }])
                    
                def lookupMarriageAccount = InvokerUtil.lookupOpener('itemacct:lookup',[onselect:{ 
                        marriage = it
                        entity.info.marriageacctid = it?.objid
                        entity.info.marriageaccttitle = it?.accttitle
                        entity.info.marriagefundid = it?.fundid
                    }]) 

                def lookupBurialAccount = InvokerUtil.lookupOpener('itemacct:lookup',[onselect:{ 
                        burial = it
                        entity.info.burialacctid = it?.objid
                        entity.info.burialaccttitle = it?.accttitle
                        entity.info.burialfundid = it?.fundid
                    }])
            }
        ]]>
    </code>
    <pages>
        <page template="com.rameses.gov.etracs.treasury.collection.collectionsetting.CollectionSettingPage"/>
    </pages>
</workunit>