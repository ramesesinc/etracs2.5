<?xml version="1.0" encoding="UTF-8"?>
<workunit>
    <invokers>
        <invoker type="collection:payment" caption="Cash - F9" shortcut="F9" target="popup" />
    </invokers>
    <code>
        <![CDATA[
            import com.rameses.rcp.annotations.*;
            import com.rameses.rcp.common.*;
            import com.rameses.osiris2.client.*;
            
            class PaymentCashController {
                @Binding
                def binding

                def acceptHandler;
                BigDecimal cashTendered = 0.00;
                
                def approve() {
                    validate();
                    invokeAcceptHandler();
                    cancel();
                }
                
                void validate() {
                    if( cashTendered <= 0 )  {
                        binding.focus('cashTendered');
                        throw new Exception( 'Cash Tendered must be greater than zero.' );
                    }
                }

                void invokeAcceptHandler() {
                    if( acceptHandler ) {
                        def paymentInfo = [
                            paytype     :'CASH', 
                            particulars :'CASH PAYMENT',
                            amount      :cashTendered,
                        ];
                        acceptHandler( paymentInfo );
                    }
                }
                
                def cancel() {
                    return "_close";
                }
            }
        ]]>
    </code>
    <pages>
        <page template="com.rameses.client.collection.CashPaymentPage" />
    </pages>
</workunit>