import com.rameses.common.*
import com.rameses.annotations.*

class CollectionSettingMasterService
{
	@PersistenceContext('main')
	def em
	
	def OBJID = 'CS01'
	def SCHEMA_NAME = 'collectionsetting'
	
	@ProxyMethod
	public def init() {}
	
	@ProxyMethod
	public Map open() {
		def cs = em.read( SCHEMA_NAME, [objid:OBJID] )
		if( cs ) return cs 
		return [
			objid : OBJID,
			info : [amount:0.0]
		]
	}
	
	@ProxyMethod
	public def getCS(){
		return em.read( SCHEMA_NAME, [objid:OBJID] )
	}
	
	@ProxyMethod
	public Map save( cs ) {
		def oldcs = em.read( SCHEMA_NAME, cs )
		if( oldcs )
			return update( cs )  
		return create( cs )
	}
	
	def create( cs ) {
		em.validate( SCHEMA_NAME, cs )
		em.create( SCHEMA_NAME, cs )
		return cs 
	}
	
	def update( cs ) {
		em.validate( SCHEMA_NAME, cs )
		em.update( SCHEMA_NAME, cs )
		return cs
	}
}