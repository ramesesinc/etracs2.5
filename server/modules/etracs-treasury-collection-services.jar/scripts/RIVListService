import com.rameses.common.*import com.rameses.annotations.*class RIVListService{	@PersistenceContext('main')	def em		@ProxyMethod	public List getList( params ) {		params.searchtext = (params.searchtext? params.searchtext+'%':'%');		params.requestedby_name = params.searchtext;		params.txnno = params.searchtext;				def qry = em.sqlContext.createNamedQuery('riv:getList');		if( params ) {			qry.setParameters(params);			if( params._start ) qry.setFirstResult(params._start);			if( params._limit ) qry.setMaxResults(params._limit);		}		return qry.resultList;	}		@ProxyMethod	public List getItemsByRivid( params ) {		params.rivid = (params.objid? params.objid:'')		def qry = em.sqlContext.createNamedQuery('riv:getItemsByRivid')		if( params ) {			qry.setParameters(params);			if( params._start ) qry.setFirstResult(params._start);			if( params._limit ) qry.setMaxResults(params._limit);		}		return qry.resultList;	}		private def searchByRequester( search, params ) {		def result = [];		if( !search.searchText ){			if((result = getListByQuery("riv:getListByRequester", [requestedby:search.requestedby, rivtype:search.rivtype], params))) return result;		} else{			if((result = getListByQuery("riv:getListByRequesterTxnno", [txnno:search.searchText +"%", requestedby:search.requestedby, rivtype:search.rivtype], params))) return result;		}		return result;	}		private def searchAll( search, params ) {		if( ! search.searchText ) return getListByQuery("riv:getList", [rivtype:search.rivtype], params);		def result = [];		if((result = getListByQuery("riv:getListByTxnno", [txnno:search.searchText, rivtype:search.rivtype], params))) return result;		if((result = getListByQuery("riv:getListByRequester", [rivtype:search.rivtype, requestedby:search.searchText+"%"], params))) return result;		return result;	}}