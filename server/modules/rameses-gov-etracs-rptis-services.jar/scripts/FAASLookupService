import com.rameses.annotations.*
import com.rameses.common.*;

class FAASLookupService
{
	@PersistenceContext('rpt')
	def em 

	
	@Service('RPTUtil')
	def utilSvc
	

	@ProxyMethod
	public def lookupFaas( params ) {
		params.state 		= (params.state ? params.state : '') + '%'
		params.taxpayerid 	= (params.taxpayerid ? params.taxpayerid : '') + '%'
		params.tdno 		= params.searchtext
		params.blockno 		= params.searchtext 
		params.searchtext 	= (params.searchtext ? params.searchtext : '') + '%';
		
		def filters = [
			' and f.tdno = $P{tdno} AND f.state LIKE $P{state} AND f.taxpayer_objid LIKE $P{taxpayerid}',
			' and f.owner_name LIKE $P{searchtext} AND f.state LIKE $P{state} AND f.taxpayer_objid LIKE $P{taxpayerid}',
			' and r.fullpin LIKE $P{searchtext} AND f.state LIKE $P{state} AND f.taxpayer_objid LIKE $P{taxpayerid}',
			' and rp.cadastrallotno LIKE $P{searchtext} AND f.state LIKE $P{state} AND f.taxpayer_objid LIKE $P{taxpayerid}',
			' and rp.blockno = $P{blockno} AND f.state LIKE $P{state} AND f.taxpayer_objid LIKE $P{taxpayerid}',
			' and rp.surveyno LIKE $P{searchtext} AND f.state LIKE $P{state} AND f.taxpayer_objid LIKE $P{taxpayerid}',
		]

		return utilSvc.getListFromQuery('faas:lookupFaas', filters, params, 'f.objid');
	}



}

