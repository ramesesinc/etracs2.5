import com.rameses.annotations.*;
import com.rameses.common.*;
import java.rmi.server.UID

class MunicipalityLookupService{
	
	@PersistenceContext('main')	
	def em
	
	@ProxyMethod
	public def lookupMunicipalities( params ) {
		params.searchtext = (params.searchtext ? params.searchtext : '')
		params.name = params.searchtext + '%'
		params.parentid = ( params.parentid ? params.parentid : '%' ) 
		
		def qry = em.sqlContext.createNamedQuery('lgu_municipality:lookup')

		if (params._start == null) 
			params._start = 0

		qry.setFirstResult( params._start )

		if (params._limit != null) 
			qry.setMaxResults(params._limit)

		return qry.setParameters(params).resultList 

	}

	@ProxyMethod
	public def lookupMunicipalityById( objid ) {
		return em.sqlContext.createNamedQuery('lgu_municipality:lookupById')
				.setParameter('objid', objid).singleResult
	}

}
