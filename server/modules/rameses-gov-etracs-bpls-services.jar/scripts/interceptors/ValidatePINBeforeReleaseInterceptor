import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import com.rameses.services.extended.*;

public class ValidatePINBeforeReleaseInterceptor {

	@ActiveDB("business")
	def em;

	@Before(pattern="BPApplicationService.release")
	public def checkPINBeforeRelease(def evt) { 
		def r = evt.args[0];
		def m = em.read( [objid:r.businessid]);
		if(!m?.pin) 
			throw new Exception("PIN is required before release");
	}



}