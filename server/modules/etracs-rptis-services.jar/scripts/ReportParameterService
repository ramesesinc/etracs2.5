import com.rameses.annotations.*
import com.rameses.common.*

class ReportParameterService{
	
	@Service('Var')
	def var;
	
	@Service('DateService')
	def dateService;

	@Env
	def env 
	
	@ProxyMethod
	public def getStandardParameter(){
		return [
			SANGGUNIAN_NAME 			: var.sanggunian_name, 
            LOGOLGU     				: var.url_logo_lgu,                    
            LOGOBLGF    				: var.url_logo_blgf,                    
            LGUNAME     				: var.lgu_name, 
			LGUFORMALNAME 				: var.lgu_formal_name, 
			LGUTYPE		  				: var.lgu_type, 
			LGUADDRESS	  				: var.lgu_address, 
            PARENTLGUNAME 				: var.parent_lgu_name,
			PARENTLGUFORMALNAME 		: var.parent_lgu_formal_name,
			PROVINCENAME  				: var.parent_lgu_name,
			MUNICIPALNAME 				: var.lgu_name,
			CITYNAME	  				: var.city_name,

			PROVINCIALTREASURERNAME		: var.provincial_treasurer_name,
			PROVINCIALTREASURERTITLE	: var.provincial_treasurer_title,
            TREASURERNAME   			: var.treasurer_name,
            TREASURERTITLE  			: var.treasurer_title,
            TREASUREROFFICENAME  		: var.treasury_officename,
			PROVINCIALASSESSORNAME 		: var.provincial_assessor_name,
			PROVINCIALASSESSORTITLE 	: var.provincial_assessor_title,
			
			ASSESSORNAME 				: var.assessor_name,
			ASSESSORTITLE 				: var.assessor_title,
			ASSESSOROFFICENAME			: var.assessor_officename,
			ASSTASSESSORNAME 			: var.asst_assessor_name,
			ASSTASSESSORTITLE 			: var.asst_assessor_title,
			
			MAYOROFFICENAME 			: var.mayor_office_name,
			MAYORNAME   				: var.mayor_name,
			MAYORTITLE  				: var.mayor_title,

			GIVENAT 					: var.lgu_address,
			USERNAME	 				: env.USERFORMALNAME,
			USERJOBTITLE 				: env.JOBTITLE, 
            PRINTDATE   				: dateService.serverDate,
			PRINTEDBY   				: env.USERFORMALNAME,
			DATE 						: formalizeDate( 'd' ), 
			MONTH 						: formalizeDate( 'MMMMM' ),
			YEAR 						: formalizeDate( 'yyyy' ),
		];
	}

	def formalizeDate( def fdt ){
		def dt = new java.text.SimpleDateFormat( fdt ).format(dateService.serverDate).toString();
		
		if( 'd'.equals(fdt) || 'dd'.equals(fdt)){
			if( dt.matches('01|1|21|31') )
				return dt + 'st';
			else if( dt.matches('02|2|22') )
				return dt + 'nd';
			else if(dt.matches('03|3|23')) 
				return dt + 'rd';
			else return dt + 'th';
		}
		return dt;
	}
	
}