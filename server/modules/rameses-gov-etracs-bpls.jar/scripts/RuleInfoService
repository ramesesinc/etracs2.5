import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import com.rameses.services.extended.*;

public class RuleInfoService {

	@Service("TemplateService")
	def tmpl;

	def getEntity() {
		def entity = [:];
		entity.name = "rule1";
		entity.conditions = [];
		
		def con = [name:'LOBFact', title:'Line of Business', varname:'LOB', constraints:[] ];
		def c1 = [field:'barangay', operator:'matches', value:['BARANGAY1','BARANGAY2'], var:'b1', text:'barangay matches BARANGAY1,BARANGAY2'  ];
		def c2 = [field:'type', operator:'is any of the ff:', value:['NEW','RENEW'], var:'atype', text:'assessment type matches NEW,RENEW'  ];
		con.constraints << c1;
		con.constraints << c2;
		entity.conditions << con;

		def con2 = [name:'BusinessInfo', title:'Business Info', constraints:[] ];
		con2.constraints << [field:'name', operator:'==', value:['CAPITAL'], text: 'CAPITAL: value' ]; 
		entity.conditions << con2;

		entity.actions = [];
		def a1 = [title:'Compute Business Tax', params: []];
		a1.params << [ name:'revtype', title:'Revenue Type' ];
		a1.params << [ name:'formula', title:'AMTPAID * 0.25' ];
		entity.actions << a1;
		return entity;
	}


	@ProxyMethod
	public def getRuleHtml(o) {
		//if(o==null) 
		o = getEntity();
		return tmpl.render( "ruleinfo.gtpl",  [entity: o] );
	}

}