import com.rameses.annotations.*;
import com.rameses.services.extended.*;

class LobService extends ActiveCrudListService {

	@ActiveDB("lob")
	def em;

	@ActiveDB("lobclassification")
	def classification;

	@ProxyMethod
	public def getColumns( def p ) {
		return [
			[name:'name', caption:'Line of Business'],
			[name:'classification.name', caption:'Classification']
		]	
	}

	@ProxyMethod
	public void addAttribute( def o ) {
		em.create( o, "attribute" );				
	}

	@ProxyMethod
	public void removeAttribute( o ) {
		em.delete( o, "attribute" );				
	}

	public void beforeRemoveEntity( def data ) {
		em.removeAttributes([lobid: data.objid]);
	}

	public void afterOpen( def data ) {
		data.classification = classification.read(data.classification);
		data.attributes = em.getAttributes([lobid: data.objid]);
	}	



}
