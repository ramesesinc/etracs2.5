import com.rameses.annotations.*;
import com.rameses.util.*;
import java.rmi.server.*;
import com.rameses.common.*;
import com.rameses.services.extended.*;

class CollectionGroupService extends ActiveCrudListService {

	@ActiveDB("collectiongroup")
	def em;

	@ProxyMethod
	public def getColumns( def o ) {
		return [
			[name:'name', caption:'Name' ],
		];
	}	

	void beforeList(o) {
		o.searchtext = (o.searchtext ? o.searchtext : '') +'%'
	} 

	protected void beforeCreate(def entity){
		em.deleteRevenueItems( entity )
	}

	protected void afterCreate(def entity){
		entity.revenueitems.each {
			em.create(it, 'collectiongroup_revenueitem')
		}
	}
	
	protected void afterRemoveEntity(def entity){
		em.deleteRevenueItems( entity )
	}

	protected void afterOpen(def entity){
		entity.revenueitems = em.getRevenueItems( entity )
	}

	protected void beforeUpdate(def entity){
		em.deleteRevenueItems( entity )
	}

	protected void afterUpdate(def entity){
		entity.revenueitems.each {
			em.create(it, 'collectiongroup_revenueitem')
		}
	}

}
